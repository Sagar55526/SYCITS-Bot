const predefinedQA = {
    "स्कूल मास्टर सॉफ्टवेअर सुरु कसे करावे ?": {
        text: "स्कूल मास्टर सॉफ्टवेअर सुरु करण्यासाठीच्या लागणाऱ्या क्रम :",
        pdf: "https://drive.google.com/file/d/10NxaufGIZ-mf5vjuGEkbgeGuxfEzk8ri/preview"
    },
    "स्कूल मास्टर सॉफ्टवेअरचे मेनू.": {
        text: "स्कूल मास्टर सॉफ्टवेअरचे मेनू पुढील पैकी आहेत :",
        pdf: "https://drive.google.com/file/d/1xEsYYP7dpa6UD7E7P1exd2piAlouaZ9I/preview"
    },
    "शाळेची माहिती कशी करावी ?": {
        text: "शाळेची माहिती भरण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1leCT5S8txxhjFngkp1UlI5djhkONlfRm/preview"
    },
    "शालेय सुट्टीचे दिवस कसे भरावी ?": {
        text: "शालेय सुट्टीचे दिवस भरण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1sjEJkEq9FPbizu5ET1Kk1QqmolpnXFuY/preview"
    },
    "EBC बिल तयार कसे करावे ?": {
        text: "EBC बिल तयार करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1czDNml7MbRxBnqg38RlSzrRq6UfIhBf6/preview"
    },
    "आपल्या वर्गाचा कॅटलॉरग कसा पाहणे व प्रिंट करणे ?": {
        text: "आपल्या वर्गाचा कॅटलॉरग पाहण्यासाठी व प्रिंट करण्यासाठी लागणाऱ्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1v8KGHPn23N9hwVU8rRQE_U6n1fxvwPp3/preview"
    },
    "इयत्ता 1 ली ते 8 वी नोंदवही व इतर रिपोर्ट प्रिंट कसे करावे ?": {
        text: "इ. 1 ली ते 8 वी नोंदवही व इतर रिपोर्ट प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1xVmyp7GPbB78xeVYxQrpHdFfZzZ74Nmj/preview"
    },
    "इयत्ता 1 ली ते 9 वी विषयावर गुणयाद्या प्रिंट कश्या करावे ?": {
        text: "इ. 1 ली ते 9 वी विषयावर गुणयाद्या प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1Fds9COvnKdIIyQQjlj5uIIBk53nunWKI/preview"
    },
    "इयत्ता 5 वी व 8 वी चा वार्षिक गुणपत्रक प्रिंट कसे करावे ?": {
        text: "इ. 5 वी व 8 वी चा वार्षिक गुणपत्रक प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1SlJSrRAFpcWmWXvm9DPBDfaF8OrY12X-/preview"
    },
    "इयत्ता 5 वी व 8 वी चा वार्षिक निकाल प्रिंट कसा करावा ?": {
        text: "इ. 5 वी व 8 वी चा वार्षिक निकाल प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1y2PXUV5RKR5sr7ZXRivRtK0o6HohdrnY/preview"
    },
    "इयत्ता 9 वी वार्षिक गुणपत्रक प्रिंट कसे करावे ?": {
        text: "इ. 9 वी वार्षिक गुणपत्रक प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1E5gZmZpZAuvhksrcvq0D8DQ30Xb5cXpx/preview"
    },
    "इयत्ता 9 वी दृष्टीक्षेपातील निकाल प्रिंट कसा करावा ?": {
        text: "इयत्ता 9 वी दृष्टीक्षेपातील निकाल प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1n6s9pyZZgWvvJILYsuvnKTjuvXR-dIWp/preview"
    },
    "इयत्ता 9 वी वार्षिक व जातीनिहाय निकाल प्रिंट कसा करावा ?": {
        text: "इयत्ता 9 वी वार्षिक व जातीनिहाय निकाल प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1y4n1IZy3DPa8ayDnDdwD48S6MU7YCDR2/preview"
    },
    "जातीनिहाय विद्यार्थी संख्या कशी पहावी किंवा प्रिंट कशी करावी ?": {
        text: "जातीनिहाय विद्यार्थी संख्या पाहण्यासाठी किंवा प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1IoWJ1-vqL6BuDswNVqJq_4G8nK5c7Ait/preview"
    },
    "तुकडी बदल कशी करावी ?": {
        text: "तुकडी बदल करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1dbexP4mecJ8K2okHBY-ezB4DOYDZPq4M/preview"
    },
    "नवीन कर्मचारी माहिती कशी भरावी ?": {
        text: "नवीन कर्मचारी माहिती भरण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/12_kOg96JgDAr2JEGT_ghkl9FrMkcVS8U/preview"
    },
    "निकालाचे रजिस्टर बाईंडिंग कशी कारावी ?": {
        text: "निकालाचे रजिस्टर बाईंडिंग करण्यासाठीच्या सूचना पुढील प्रमाणे :",
        pdf: "https://drive.google.com/file/d/1VXeDiQJ5-o3tb8XWAkZy7l_yFzjes4-V/preview"
    },
    "प्रगतीचे दुसरे पान प्रिंट कसे करावे (इयत्ता 1 ली ते 4 थी, 6 वी, 7 वी) ?": {
        text: "प्रगतीचे दुसरे पान प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1wNloys8Vca0nHAktIAzTCYmwjtEU9M2b/preview"
    },
    "प्रगतीचे पहिले पान प्रिंट कसे करावे (इयत्ता 1 ली ते 4 थी, 6 वी, 7 वी) ?": {
        text: "प्रगतीचे पहिले पान प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1WB4SFDckC1hc5z5yUL1OWK6m7bwG9N7C/preview"
    },
    "बोर्ड फॉर्म प्रिंट कसा करावा ?": {
        text: "बोर्ड फॉर्म प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/16T6kjK2zbvowNI1ycSJtVHHLxcQ-6reb/preview"
    },
    "मागील दाखले प्रिंट कसे करावे ?": {
        text: "मागील दाखले प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1aIxcKD5AoiNPKBRMi7uv5TTnMmXe5X5O/preview"
    },
    "मुख्याध्यापक यांनी शाळेतील सर्व वर्गांचे निकाल कसे तपासावे ?": {
        text: "मुख्याध्यापक यांनी शाळेतील सर्व वर्गांचे निकाल तपासण्याच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1YHpACI7tb9-SLgyCvKdbOqUgJjYhfcqd/preview"
    },
    "वर्गनिहाय विद्यार्थी संख्या कशी पहावी किंवा प्रिंट करावी ?": {
        text: "वर्गनिहाय विद्यार्थी संख्या कशी पाहण्यासाठी किंवा प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1IMUtPP-lcfuZJHnu07do-HIKsWtmo-86/preview"
    },
    "वर्गाची मासिक हजेरी पहावी किवा प्रिंट कशी करावी ?": {
        text: "वर्गाची मासिक हजेरी पाहण्यासाठी किवा प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1VNbBzUa2BLVt2wT-p-Ipu4ajCI8oKo0P/preview"
    },
    "वर्गातील सर्व विद्यार्थ्यांचे बोनाफाईड एकाच वेळेस प्रिंट कशी करावी ?": {
        text: "वर्गातील सर्व विद्यार्थ्यांचे बोनाफाईड एकाच वेळेस प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1Sc2b6UecbASygby7Hn0fOgjIR1MP6v_C/preview"
    },
    "विद्यार्थी उंची व वजन भरणे कसे करावे ?": {
        text: "विद्यार्थी उंची व वजन भरण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1teHo5o6oezFtOVuPHAlsVb7WcMiEK3VM/preview"
    },
    "विद्यार्थी दाखला तयार करून प्रिंट कसे करावे ( अनेक  विद्यार्थी ) ?": {
        text: "विद्यार्थी (अनेक विद्यार्थी) दाखला तयार करून प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1f_4CuncMtoNI9pDauEUKezce96obSyCl/preview"
    },
    "विद्यार्थी दाखला तयार करून प्रिंट कसे करावे ( एक विद्यार्थी ) ?": {
        text: "विद्यार्थी (एक विद्यार्थी) दाखला तयार करून प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1epIq0j-1weMwP7zRGEU3T-XYCz4rdGzE/preview"
    },
    "विद्यार्थी दाखला दुरुस्त कसा करावा ?": {
        text: "विद्यार्थी दाखला दुरुस्त करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1vsqq8YXXxaAduDCW47fPBQYuHLvdYbya/preview"
    },
    "विद्यार्थी दाखला रद्द कसा करावा ?": {
        text: "विद्यार्थी दाखला रद्द करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1L7qyLN5QPSGy1d9xT56p5HVO0Zg2WUXR/preview"
    },
    "विद्यार्थी नाव पटावर कसे आणावे ?": {
        text: "विद्यार्थी नाव पटावर कसे आणण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1w4OxwZ0iKCTDGzxaU2CPLN8r5N-PTwAK/preview"
    },
    "विद्यार्थी नाव पटावरून कमी कसे करावे ?": {
        text: "विद्यार्थी नाव पटावरून कमी करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1opu68kXBLUS0hjPXncVVbrmtad9062qp/preview"
    },
    "विद्यार्थी पुढील वर्गात प्रोमोट कसे करावे ?": {
        text: "विद्यार्थी पुढील वर्गात प्रोमोट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1VLYSHny-kfC1nxVKKjsPLpZ5vRQFSuuH/preview"
    },
    "विद्यार्थी बोनाफाईड प्रिंट करावे ?": {
        text: "विद्यार्थी बोनाफाईड प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1WmfsajTFkjUreBxlt5xBneSiAN5A1E6Z/preview"
    },
    "विद्यार्थी माहिती कशी भरावी ?": {
        text: "विद्यार्थी माहिती भरण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1P7XPdH6EX86YHUnHBUJ22DvNV8savPVT/preview"
    },
    "विद्यार्थी माहितीत बदल कसा करावा ?": {
        text: "विद्यार्थी माहितीत बदल करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/12-BhR_u0GZ0LsxynBNEIry3oAEIQWeXP/preview"
    },
    "विद्यार्थी यादी प्रिंट कशी करावी ?": {
        text: "विद्यार्थी यादी प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1MHJ6rARupjv8s4V_CwbuHPeIHCfzHBAk/preview"
    },
    "विद्यार्थ्यांची दैनिक हजेरी कशी भरावी ?": {
        text: "विद्यार्थ्यांची दैनिक हजेरी भरण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1lGVtl40ee5zVZjk7L00SbZkUn1xrPQD1/preview"
    },
    "शिक्षकांनी स्क्रीन वर निकाल कसा तपासावा यासाठी मार्गदर्शक सूचना.": {
        text: "शिक्षकांनी स्क्रीन वर निकाल कसा तपासावा यासाठी मार्गदर्शक सूचना पुढीलप्रमाणे आहेत :",
        pdf: "https://drive.google.com/file/d/16n7q12jNU1g23TeWsOJNTfxcqBmr66to/preview"
    },
    "स्पर्धक विद्यार्थी नोंद कशी करावी ?": {
        text: "स्पर्धक विद्यार्थी नोंद करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1O97BJXJ4P78I0YXGDxyMf6I4rbEKxyQP/preview"
    },
    "हजेरी प्रिंट कशी करावी ?": {
        text: "हजेरी प्रिंट करण्यासाठीच्या पद्धती :",
        pdf: "https://drive.google.com/file/d/1wOARipoBUWl12ojsNeNU7IGGIJmG0wxT/preview"
    }
};

const initialQuestions = [
    "स्कूल मास्टर सॉफ्टवेअर सुरु कसे करावे ?",
    "स्कूल मास्टर सॉफ्टवेअरचे मेनू.",
    "शाळेची माहिती कशी करावी ?",
    "शालेय सुट्टीचे दिवस कसे भरावी ?",
    "EBC बिल तयार कसे करावे ?",
    "आपल्या वर्गाचा कॅटलॉरग कसा पाहणे व प्रिंट करणे ?",
    "इ. 1 ली ते 8 वी नोंदवही व इतर रिपोर्ट प्रिंट कसे करावे ?",
    "इ. 1 ली ते 9 वी विषयावर गुणयाद्या प्रिंट कसे करावे ?",
    "इ. 5 वी व 8 वी चा वार्षिक गुणपत्रक प्रिंट कसे करावे ?",
    "इ. 5 वी व 8 वी चा वार्षिक निकाल प्रिंट कसा करावा ?",
    "इ. 9 वी वार्षिक गुणपत्रक प्रिंट कसे करावे ?",
    "इयत्ता 9 वी दृष्टीक्षेपातील निकाल प्रिंट कसा करावा ?",
    "इयत्ता 9 वी वार्षिक व जातीनिहाय निकाल प्रिंट कसा करावा ?",
    "जातीनिहाय विद्यार्थी संख्या कशी पहावी किंवा प्रिंट कशी करावी ?",
    "तुकडी बदल कशी करावी ?",
    "नवीन कर्मचारी माहिती कशी भरावी ?",
    "निकालाचे रजिस्टर बाईंडिंग कशी कारावी ?",
    "प्रगतीचे दुसरे पान प्रिंट कसे करावे (इयत्ता 1 ली ते 4 थी, 6 वी, 7 वी) ?",
    "प्रगतीचे पहिले पान प्रिंट कसे करावे (इयत्ता 1 ली ते 4 थी, 6 वी, 7 वी) ?",
    "बोर्ड फॉर्म प्रिंट कसा करावा ?",
    "मागील दाखले प्रिंट कसे करावे ?",
    "मुख्याध्यापक यांनी शाळेतील सर्व वर्गांचे निकाल कसे तपासावे ?",
    "वर्गनिहाय विद्यार्थी संख्या कशी पहावी किंवा प्रिंट करावी ?",
    "वर्गाची मासिक हजेरी पहावी किवा प्रिंट कशी करावी ?",
    "वर्गातील सर्व विद्यार्थ्यांचे बोनाफाईड एकाच वेळेस प्रिंट कशी करावी ?",
    "विद्यार्थी उंची व वजन भरणे कसे करावे ?",
    "विद्यार्थी दाखला तयार करून प्रिंट कसे करावे ( अनेक  विद्यार्थी ) ?",
    "विद्यार्थी दाखला तयार करून प्रिंट कसे करावे ( एक विद्यार्थी ) ?",
    "विद्यार्थी दाखला दुरुस्त कसा करावा ?",
    "विद्यार्थी दाखला रद्द कसा करावा ?",
    "विद्यार्थी नाव पटावर कसे आणावे ?",
    "विद्यार्थी नाव पटावरून कमी कसे करावे ?",
    "विद्यार्थी पुढील वर्गात प्रोमोट कसे करणे ?",
    "विद्यार्थी बोनाफाईड प्रिंट करावे ?",
    "विद्यार्थी माहिती कशी भरावी ?",
    "विद्यार्थी माहितीत बदल कसा करावा ?",
    "विद्यार्थी यादी प्रिंट कशी करावी ?",
    "विद्यार्थ्यांची दैनिक हजेरी कशी भरावी ?",
    "शिक्षकांनी स्क्रीन वर निकाल कसा तपासावा यासाठी मार्गदर्शक सूचना",
    "स्पर्धक विद्यार्थी नोंद कशी करावी ?",
    "हजेरी प्रिंट कशी करावी ?"
];


function toggleChat() {
    const chatContainer = document.getElementById('chat-container');
    const chatBox = document.getElementById('chat-box');
    const chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];

    chatContainer.style.display = chatContainer.style.display === 'none' || chatContainer.style.display === '' ? 'block' : 'none';

    if (chatContainer.style.display === 'block') {
        if (!chatBox.hasChildNodes()) {
            if (chatHistory.length === 0) {
                addMessageToChatBox("Bot", "How can I help you?", "bot-message");
            } else {
                loadChatHistory();
            }
        }
    } else {
        saveChatHistory();
        chatBox.innerHTML = '';
    }
}

//function toggleChat() {
//    const chatContainer = document.getElementById('chat-container');
//    const chatBox = document.getElementById('chat-box');
//    chatContainer.style.display = chatContainer.style.display === 'none' || chatContainer.style.display === '' ? 'block' : 'none';

//    if (chatContainer.style.display === 'block') {
//        const chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];
//        if (chatHistory.length === 0) {
//            addMessageToChatBox("Bot", "How can I help you?", "bot-message");
//        } else {
//            loadChatHistory();
//        }
//    } else {
//        saveChatHistory();
//        chatBox.innerHTML = '';
//    }
//}


function showInitialQuestions() {
    const chatBox = document.getElementById('chat-box');
    clearChatBox();

    const botOptionsContainer = document.createElement('div');
    botOptionsContainer.className = 'bot-options';

    initialQuestions.forEach(question => {
        const button = document.createElement('button');
        button.className = 'bot-option';
        button.textContent = question;
        button.onclick = (event) => {
            event.preventDefault(); 
            handleInitialQuestionSelection(question);
        };
        botOptionsContainer.appendChild(button);
    });

    chatBox.appendChild(botOptionsContainer);
    chatBox.scrollTop = chatBox.scrollHeight;
}


function addMessageToChatBox(sender, message, messageType) {
    const chatBox = document.getElementById('chat-box');
    const messageElement = document.createElement('div');
    messageElement.className = `message ${messageType}`;
    messageElement.textContent = `${sender}: ${message}`;
    chatBox.appendChild(messageElement);
    chatBox.scrollTop = chatBox.scrollHeight;

    // Save message to localStorage
    if (!(sender === "Bot" && message === "How can I help you?")) {
        saveMessageToLocalStorage({ sender, message, messageType });
    }
}


function handleInitialQuestionSelection(question) {
    clearInitialQuestions();
    addMessageToChatBox("You", question, "user-message");
    const response = predefinedQA[question];

    if (response) {
        if (typeof response === 'object' && response.pdf) {
            addMessageToChatBox("Bot", response.text, "bot-message");
            addPdfToChatBox(response.pdf);
        } else {
            addMessageToChatBox("Bot", response, "bot-message");
        }
    } else {
        addMessageToChatBox("Bot", "Sorry, I don't understand that question.", "bot-message");
    }
}

function clearInitialQuestions() {
    const chatBox = document.getElementById('chat-box');
    const botOptionsContainer = chatBox.querySelector('.bot-options');
    if (botOptionsContainer) {
        botOptionsContainer.parentNode.removeChild(botOptionsContainer);
    }
}

function clearChatBox() {
    const chatBox = document.getElementById('chat-box');
    while (chatBox.firstChild) {
        chatBox.removeChild(chatBox.firstChild);
    }
}

function sendMessage(event) {
    event.preventDefault(); 
    const userInput = document.getElementById('user-input').value.toLowerCase().trim();
    if (userInput) {
        const filteredQuestions = initialQuestions.filter(question => question.toLowerCase().includes(userInput));

        if (filteredQuestions.length > 0) {
            clearInitialQuestions();
            filteredQuestions.forEach(question => {
                addQuestionButtonToChatBox(question);
            });
        } else {
            addMessageToChatBox("Bot", "Sorry, no matching questions found.", "bot-message");
        }

        document.getElementById('user-input').value = '';
    }
}

function addQuestionButtonToChatBox(question) {
    const chatBox = document.getElementById('chat-box');
    const button = document.createElement('button');
    button.className = 'bot-option';
    button.textContent = question;
    button.onclick = (event) => {
        event.preventDefault(); 
        handleQuestionButtonSelection(question);
    };
    chatBox.appendChild(button);
}

function handleQuestionButtonSelection(question) {
    //clearInitialQuestions();
    //handleInitialQuestionSelection(question);
    event.stopPropagation(); 
    clearInitialQuestions();
    handleInitialQuestionSelection(question);
}

function addMessageToChatBox(sender, message, messageType) {
    const chatBox = document.getElementById('chat-box');
    const messageElement = document.createElement('div');
    messageElement.className = `message ${messageType}`;
    messageElement.textContent = `${sender}: ${message}`;
    chatBox.appendChild(messageElement);
    chatBox.scrollTop = chatBox.scrollHeight;

    // Save message to localStorage
    if (sender !== "Bot" || message !== "How can I help you?") {
        saveMessageToLocalStorage({ sender, message, messageType });
    }
}

function addPdfToChatBox(pdfUrl) {
    const chatBox = document.getElementById('chat-box');
    const pdfContainer = document.createElement('div');
    pdfContainer.className = 'pdf-container';

    const embed = document.createElement('embed');
    embed.src = pdfUrl; 
    embed.width = '100%';
    embed.height = '400px';

    pdfContainer.appendChild(embed);
    chatBox.appendChild(pdfContainer);
    chatBox.scrollTop = chatBox.scrollHeight;

    saveMessageToLocalStorage({ sender: 'Bot', message: '', messageType: 'pdf', pdfUrl });
}

function saveMessageToLocalStorage(message) {
    let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];
    chatHistory.push(message);
    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
}

function loadChatHistory() {
    let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];
    chatHistory.forEach(({ sender, message, messageType, pdfUrl }) => {
        if (messageType === 'pdf') {
            addPdfToChatBox(pdfUrl);
        } else {
            addMessageToChatBox(sender, message, messageType);
        }
    });
}

function saveChatHistory() {
    const chatBox = document.getElementById('chat-box');
    const messages = chatBox.querySelectorAll('.message, .pdf-container');
    const chatHistory = [];

    messages.forEach(element => {
        if (element.classList.contains('pdf-container')) {
            const embed = element.querySelector('embed');
            chatHistory.push({ sender: 'Bot', message: '', messageType: 'pdf', pdfUrl: embed.src });
        } else {
            const sender = element.classList.contains('user-message') ? 'You' : 'Bot';
            chatHistory.push({ sender, message: element.textContent.split(': ')[1], messageType: element.className.split(' ')[1] });
        }
    });

    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
}

function clearChatHistory() {
    localStorage.removeItem('chatHistory');
    clearChatBox();
}
